---
title: "Happiness"
output: pdf_document
date: "2025-12-12"
---

```{r}
library(readr)
library(dplyr)
library(ggplot2) 
library(psych)
library(car)
library(tidyr)
library(reshape2)
library(broom)
```




```{r}
X2015 <- read_csv("2015.csv", show_col_types = FALSE) %>% mutate(Year = 2015)
X2016 <- read_csv("2016.csv", show_col_types = FALSE) %>% mutate(Year = 2016)
X2017 <- read_csv("2017.csv", show_col_types = FALSE) %>% mutate(Year = 2017)
X2018 <- read_csv("2018.csv", show_col_types = FALSE) %>% mutate(Year = 2018)
X2019 <- read_csv("2019.csv", show_col_types = FALSE) %>% mutate(Year = 2019)
X2020 <- read_csv("2020.csv", show_col_types = FALSE) %>% mutate(Year = 2020)
X2021 <- read_csv("2021.csv", show_col_types = FALSE) %>% mutate(Year = 2021)
X2022 <- read_csv("2022.csv", show_col_types = FALSE) %>% mutate(Year = 2022)

```
```{r}
X2015 <- read_csv("2015.csv", show_col_types = FALSE) %>% mutate(Year = 2015)
head(X2015)

  transmute(
    Country,
    Region,
    Score = as.numeric(`Happiness Score`),
    GDP = as.numeric(`Economy (GDP per Capita)`),
    Social_support = as.numeric(Family),
    Healthy_life_expectancy = as.numeric(`Health (Life Expectancy)`),
    Freedom = as.numeric(Freedom),
    Generosity = as.numeric(Generosity),
    Corruption = as.numeric(`Trust (Government Corruption)`),
    Year = 2015
  )

X2015 <- read_csv("2015.csv", show_col_types = FALSE) %>% mutate(Year = 2015)
head(X2015)

  transmute(
    Country,
    Region,
    Score = as.numeric(`Happiness Score`),
    GDP = as.numeric(`Economy (GDP per Capita)`),
    Social_support = as.numeric(Family),
    Healthy_life_expectancy = as.numeric(`Health (Life Expectancy)`),
    Freedom = as.numeric(Freedom),
    Generosity = as.numeric(Generosity),
    Corruption = as.numeric(`Trust (Government Corruption)`),
    Year = 2016
  )

X2017 <- read_csv("~/Downloads/archive/2017.csv", show_col_types = FALSE) %>%
  transmute(
    Country,
    Region = NA_character_,
    Score = as.numeric(`Happiness.Score`),
    GDP = as.numeric(`Economy..GDP.per.Capita.`),
    Social_support = as.numeric(Family),
    Healthy_life_expectancy = as.numeric(`Health..Life.Expectancy.`),
    Freedom = as.numeric(Freedom),
    Generosity = as.numeric(Generosity),
    Corruption = as.numeric(`Trust..Government.Corruption.`),
    Year = 2017
  )

X2018 <- read_csv("~/Downloads/archive/2018.csv", show_col_types = FALSE) %>%
  transmute(
    Country = `Country or region`,
    Region = NA_character_,
    Score = as.numeric(Score),
    GDP = as.numeric(`GDP per capita`),
    Social_support = as.numeric(`Social support`),
    Healthy_life_expectancy = as.numeric(`Healthy life expectancy`),
    Freedom = as.numeric(`Freedom to make life choices`),
    Generosity = as.numeric(Generosity),
    Corruption = as.numeric(`Perceptions of corruption`),
    Year = 2018
  )

X2019 <- read_csv("~/Downloads/archive/2019.csv", show_col_types = FALSE) %>%
  transmute(
    Country = `Country or region`,
    Region = NA_character_,
    Score = as.numeric(Score),
    GDP = as.numeric(`GDP per capita`),
    Social_support = as.numeric(`Social support`),
    Healthy_life_expectancy = as.numeric(`Healthy life expectancy`),
    Freedom = as.numeric(`Freedom to make life choices`),
    Generosity = as.numeric(Generosity),
    Corruption = as.numeric(`Perceptions of corruption`),
    Year = 2019
  )

X2020 <- read_csv("~/Downloads/archive/2020.csv", show_col_types = FALSE) %>%
  transmute(
    Country = `Country name`,
    Region = `Regional indicator`,
    Score = as.numeric(`Ladder score`),
    GDP = as.numeric(`Logged GDP per capita`),
    Social_support = as.numeric(`Social support`),
    Healthy_life_expectancy = as.numeric(`Healthy life expectancy`),
    Freedom = as.numeric(`Freedom to make life choices`),
    Generosity = as.numeric(Generosity),
    Corruption = as.numeric(`Perceptions of corruption`),
    Year = 2020
  )

X2021 <- read_csv("~/Downloads/archive/2021.csv", show_col_types = FALSE) %>%
  transmute(
    Country = `Country name`,
    Region = `Regional indicator`,
    Score = as.numeric(`Ladder score`),
    GDP = as.numeric(`Logged GDP per capita`),
    Social_support = as.numeric(`Social support`),
    Healthy_life_expectancy = as.numeric(`Healthy life expectancy`),
    Freedom = as.numeric(`Freedom to make life choices`),
    Generosity = as.numeric(Generosity),
    Corruption = as.numeric(`Perceptions of corruption`),
    Year = 2021
  )

X2022 <- read_csv("~/Downloads/archive/2022.csv", show_col_types = FALSE) %>%
  transmute(
    Country,
    Region = NA_character_,
    Score = as.numeric(`Happiness score`),
    GDP = as.numeric(`Explained by: GDP per capita`),
    Social_support = as.numeric(`Explained by: Social support`),
    Healthy_life_expectancy = as.numeric(`Explained by: Healthy life expectancy`),
    Freedom = as.numeric(`Explained by: Freedom to make life choices`),
    Generosity = as.numeric(`Explained by: Generosity`),
    Corruption = as.numeric(`Explained by: Perceptions of corruption`),
    Year = 2022
  )

happiness <- bind_rows(
  X2015, X2016, X2017, X2018, X2019, X2020, X2021, X2022
) %>%
  drop_na()

glimpse(happiness)

```


```{r}
ggplot(happiness, aes(x = GDP, y = Score, color = Region)) +
  geom_point(alpha = 0.5) +
  geom_smooth(method = "lm", se = FALSE) +
  labs(title = "GDP vs Happiness Score by Region", x = "GDP per Capita", y = "Happiness Score") +
  theme_light()


ggplot(happiness, aes(x = GDP, y = Score, color = Region)) +
  geom_point(alpha = 0.6) +
  geom_smooth(method = "lm", se = FALSE) +
  facet_wrap(~Year) +
  labs(title = "GDP vs Happiness Score Across Years",
       x = "GDP per Capita", y = "Happiness Score") +
  theme_light()

#boxplot
ggplot(happiness, aes(x = Region, y = Score, fill = Region)) +
  geom_boxplot(alpha = 0.6, outlier.shape = NA) +
  geom_jitter(width = 0.2, alpha = 0.4, color = "black") +
  labs(title = "Happiness Scores by Region", x = "Region", y = "Happiness Score") +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))


corr_data <- happiness %>%
  select(Score, GDP, Social_support, Healthy_life_expectancy, Freedom, Generosity, Corruption) %>%
  cor(use = "complete.obs") %>%
  as.data.frame()

corr_data$Var1 <- rownames(corr_data)

melted_corr <- corr_data %>%
  pivot_longer(cols = -Var1, names_to = "Var2", values_to = "value")

ggplot(melted_corr, aes(x = Var1, y = Var2, fill = value)) +
  geom_tile(color = "white") +
  geom_text(aes(label = round(value, 2)), color = "black", size = 3) +
  scale_fill_gradient2(low = "red", high = "blue", mid = "white", midpoint = 0) +
  labs(title = "Correlation Heatmap of Happiness Factors") +
  theme_minimal() #correlation


happiness %>%
  group_by(Year, Region) %>%
  summarise(mean_score = mean(Score, na.rm = TRUE), .groups = "drop") %>%  #summary
  ggplot(aes(x = Year, y = mean_score, color = Region)) +
  geom_line(size = 1.2) +
  geom_point(size = 2) +
  labs(title = "Average Happiness Score Over Time by Region",
       x = "Year", y = "Mean Happiness Score") +
  theme_minimal()

ggplot(happiness, aes(x = Score, fill = Region)) +
  geom_density(alpha = 0.4) +
  labs(title = "Distribution of Happiness Scores by Region",
       x = "Happiness Score", y = "Density") +
  theme_minimal() +
  theme(legend.position = "bottom")


```

```{r}
eu_africa <- happiness %>% filter(Region %in% c("Western Europe", "Sub-Saharan Africa"))
t_test_result <- t.test(Score ~ Region, data = eu_africa)
print(t_test_result)

```
```{r}
ggplot(eu_africa, aes(x = Region, y = Score, fill = Region)) +
  geom_boxplot(alpha = 0.7) +
  geom_jitter(width = 0.2, alpha = 0.4) +
  labs(title = "Happiness Scores: Western Europe vs Sub-Saharan Africa")

cor_result <- cor.test(happiness$GDP, happiness$Score, method = "pearson")
print(cor_result)

```
```{r}
ggplot(happiness, aes(x = GDP, y = Score, color = Region)) +
  geom_point(alpha = 0.6) +
  geom_smooth(method = "lm", se = TRUE, color = "black") +
  labs(title = "Correlation Between GDP and Happiness")

cor_matrix <- happiness %>%
  select(Score, GDP, Social_support, Healthy_life_expectancy, Freedom, Generosity, Corruption) %>%
  cor(use = "complete.obs")

```
```{r}
corr_data <- as.data.frame(cor_matrix)
corr_data$Var1 <- rownames(corr_data)
melted_corr <- corr_data %>% pivot_longer(cols = -Var1, names_to = "Var2", values_to = "value")

ggplot(melted_corr, aes(x = Var1, y = Var2, fill = value)) +
  geom_tile(color = "white") +
  geom_text(aes(label = round(value, 2)), color = "black", size = 3) +
  scale_fill_gradient2(low = "red", high = "blue", mid = "white", midpoint = 0) +
  labs(title = "Correlation Heatmap of Happiness Factors")

```
```{r}
model <- lm(Score ~ GDP + Social_support + Healthy_life_expectancy + Freedom + Generosity + Corruption, data = happiness)
summary(model)

ggplot(happiness, aes(x = GDP, y = Score)) +
  geom_point(alpha = 0.5, color = "blue") +
  geom_smooth(method = "lm", se = TRUE, color = "red") +
  labs(title = "Regression: GDP vs Happiness Score",
       x = "GDP per Capita", y = "Happiness Score") +
  theme_minimal()
```

```{r}
coef_data <- tidy(model, conf.int = TRUE)

ggplot(coef_data, aes(x = estimate, y = term)) +
  geom_point(color = "darkblue", size = 3) +
  geom_errorbarh(aes(xmin = conf.low, xmax = conf.high), height = 0.2) +
  labs(title = "Regression Coefficients with 95% CI",
       x = "Estimate", y = "Predictor") +
  theme_minimal()

```
```{r}
par(mfrow = c(2,2))
plot(model)
par(mfrow = c(1,1))

```


```{r}

describe(happiness$Score)

region_means <- happiness %>%
  group_by(Region) %>%
  summarise(mean_score = mean(Score, na.rm = TRUE), .groups = "drop")

print(region_means)

```





